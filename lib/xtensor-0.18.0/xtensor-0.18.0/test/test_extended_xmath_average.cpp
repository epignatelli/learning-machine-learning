
#include <algorithm>

#include "gtest/gtest.h"
#include "xtensor/xarray.hpp"
#include "xtensor/xtensor.hpp"
#include "xtensor/xmath.hpp"

// This file is generated from test/files/cppy_source/test_extended_xmath_average.cppy by preprocess.py!

namespace xt
{
    using namespace xt::placeholders;

    /*py
    a  = np.random.random(4*5*6*7).reshape(4,5,6,7)
    w  = np.random.random(4*5*6*7).reshape(4,5,6,7)
    av = np.average(a, weights=w, axis=(0,1))
    */
    TEST(xtest_extended_xmath, average)
    {
        // py_a
        xarray<double> py_a = {{{{9.9676318451371482e-01,3.9730618453933475e-01,
                                  9.6839544656576582e-01,6.5108387668022183e-02,
                                  7.4864636830291476e-01,3.7412542406878402e-01,
                                  7.2359844421248976e-01},
                                 {4.6378281704115232e-01,8.3205402198057943e-02,
                                  5.3800895026605455e-02,8.1863806579094744e-01,
                                  3.1425330771950633e-01,2.6424778168311092e-01,
                                  7.9621904679323896e-01},
                                 {6.6899029176131319e-01,4.4882219445708027e-02,
                                  4.8802761377630965e-01,5.6227664134614408e-01,
                                  3.4429739250076508e-01,6.5432664885385117e-01,
                                  6.0038054798714402e-01},
                                 {4.1888750331718150e-01,9.9663088204204353e-01,
                                  2.2509494886636794e-01,3.7673711439173663e-01,
                                  1.3757756090733086e-01,7.1706314955799377e-02,
                                  8.6495327767338859e-01},
                                 {4.0264901509095274e-01,3.3817825197233475e-01,
                                  8.6069042696785791e-01,7.7204934445680806e-01,
                                  7.9621636366584447e-01,5.2102938942614163e-01,
                                  3.0073140156846478e-01},
                                 {3.5195288263760005e-01,8.1601147191971579e-01,
                                  6.3173810466916480e-01,8.1048518890857169e-01,
                                  8.9377827059420667e-01,3.9903209327298772e-01,
                                  6.3809886506120683e-01}},
                              
                                {{2.2834604146678894e-01,5.5914577266384591e-01,
                                  8.2098721870617264e-01,1.9560341320376839e-01,
                                  7.5198931147458625e-01,3.5309242536793273e-01,
                                  5.2205928537415580e-01},
                                 {1.7209479503416369e-01,1.3456772196982170e-01,
                                  9.5360402690603974e-01,1.1936177185069685e-01,
                                  2.2031733466447856e-01,2.7418172155916509e-01,
                                  4.8011690744384405e-01},
                                 {5.7879294929845726e-01,7.3553276342188201e-01,
                                  2.6750581205603918e-01,9.8354498580761152e-01,
                                  9.9721502473777979e-01,4.0485614594926389e-02,
                                  2.0032769612638934e-01},
                                 {3.8889809329278535e-01,3.6703777131015236e-01,
                                  6.5307169622155103e-02,2.0432069737975245e-01,
                                  6.2696700576741238e-01,1.8493124998385335e-01,
                                  9.0947936758032144e-01},
                                 {3.8992294636026104e-01,5.4612125038682457e-01,
                                  8.9478317414294595e-01,3.6989040217868130e-01,
                                  1.4606900414025203e-01,8.6287748943970288e-02,
                                  1.9143613674783966e-01},
                                 {9.2422969600861515e-01,9.9290074026282593e-01,
                                  1.6118740424935463e-01,3.9059524266714607e-01,
                                  1.7975799872575571e-01,1.1598564100250730e-01,
                                  4.3628758977418480e-01}},
                              
                                {{9.3154223618579191e-01,1.5199389532996133e-01,
                                  6.4604523627073840e-01,3.7025816307037029e-01,
                                  8.4764066327006060e-01,1.6097524219034209e-02,
                                  1.4920221645581400e-01},
                                 {6.3441826774110521e-01,8.5359981718724620e-01,
                                  6.5175777187400019e-01,2.9513255483508283e-01,
                                  7.0941026407243368e-01,5.4138419493586942e-01,
                                  6.8455201680526379e-01},
                                 {5.1442872070763701e-02,9.5723354665944127e-01,
                                  9.7712215584877971e-01,7.5512082579103545e-01,
                                  4.9146441995212398e-01,8.7060164201377443e-01,
                                  7.7034724378913366e-01},
                                 {3.3934409638643259e-01,3.2948973037032370e-02,
                                  5.5085622162260151e-01,7.4699817313728611e-01,
                                  5.1426343596956858e-02,7.4858337358616522e-01,
                                  1.1274259609716542e-01},
                                 {1.9852301512807091e-01,7.8934445217491245e-01,
                                  4.5217175529975107e-01,5.3470887230283248e-01,
                                  7.9291896826047625e-01,3.7463995516529014e-03,
                                  8.4797341781839319e-01},
                                 {5.5475910963065767e-01,6.6170707229960191e-01,
                                  1.9054727341434707e-01,3.5999958484276118e-01,
                                  3.3742234144107208e-01,1.8941324700400997e-02,
                                  3.3137989786531674e-01}},
                              
                                {{8.9911542284376678e-01,9.7957783376649266e-01,
                                  5.8484260621507966e-01,8.7795859338125792e-01,
                                  2.4367159407506889e-02,3.8122281896344312e-01,
                                  4.4501918126119311e-01},
                                 {7.4825215983441051e-01,7.7096016395534195e-01,
                                  8.7503509909916621e-01,5.3831192628614688e-02,
                                  1.3932935252595147e-01,2.0439678934620620e-01,
                                  4.2565814185201611e-01},
                                 {3.6371174854536448e-01,9.6435033012366544e-01,
                                  7.2157331508612110e-01,2.4856729703118230e-01,
                                  8.3922217295930712e-01,6.6170206013694632e-01,
                                  8.2022468338126375e-01},
                                 {8.6142322026754370e-01,9.5912560346214137e-01,
                                  3.3568937475427696e-01,4.1190300717950601e-02,
                                  4.8400889288847804e-01,8.6491586554537170e-01,
                                  7.4095198366057424e-01},
                                 {4.6243546812309499e-01,2.5126893723627841e-01,
                                  9.6017903546965278e-01,9.9508930829403319e-01,
                                  6.2641631283541022e-01,9.7838500619803448e-01,
                                  1.0281818186235103e-01},
                                 {7.5390599110500423e-01,1.8375258585421428e-01,
                                  1.3619482913856462e-01,1.6830629792884622e-01,
                                  2.8713319507943835e-01,1.7479578287495967e-01,
                                  8.0768872671642133e-01}},
                              
                                {{4.4844344783282308e-01,6.8225218396591014e-02,
                                  3.1829212604617596e-01,5.6921239514838307e-01,
                                  6.0768876638565616e-01,3.8343562372333950e-01,
                                  3.2580784353657621e-01},
                                 {7.6871970961916125e-01,4.0431531924185760e-01,
                                  6.8754329525585722e-01,2.6323860681357913e-01,
                                  5.2785959174482067e-01,9.5511292181841101e-01,
                                  2.9485659846591650e-01},
                                 {3.3931391384216958e-01,7.2957975540833564e-01,
                                  7.2778070312893384e-01,9.5644705451867962e-01,
                                  4.5966919044075183e-01,2.9707451635596627e-04,
                                  1.1101969664703759e-01},
                                 {6.6255850796173132e-02,3.7653173563698428e-01,
                                  7.8971835339461549e-01,8.5862126855142751e-01,
                                  1.8587418326295302e-01,8.4044202255959499e-01,
                                  1.5459435015146616e-01},
                                 {1.0398132895738410e-01,8.7724970450074324e-02,
                                  8.0661718927423909e-01,3.9921544850098312e-01,
                                  6.2071966930976719e-02,9.6782972189221328e-01,
                                  2.8507176400031964e-01},
                                 {7.4364120792789179e-01,1.6227317109806993e-01,
                                  9.8360097828861071e-01,4.9575824499122678e-01,
                                  4.1835433715908432e-01,8.4657503434926518e-01,
                                  2.8749332532184169e-01}}},
                              
                              
                               {{{7.6552023950974291e-01,6.7655959604181060e-01,
                                  9.0102428456017325e-01,7.7494095532805518e-01,
                                  7.4310905771424729e-01,7.6076703928784695e-01,
                                  6.7241624743478601e-01},
                                 {1.9001462180287831e-01,1.3335663810994036e-01,
                                  4.4827677475220884e-01,4.2072540328757380e-01,
                                  1.6728433210071236e-01,6.0871005532544320e-02,
                                  4.2148697228149601e-01},
                                 {6.8480112136026861e-01,4.8241445228301860e-01,
                                  5.5582953410224878e-01,2.2119726415215313e-02,
                                  7.7333522482561090e-01,8.3058569319376196e-01,
                                  8.7563289709201786e-01},
                                 {8.7494335209624796e-02,9.9091692394680730e-01,
                                  9.2080277227492091e-01,2.1319189298340813e-01,
                                  3.0273714168670940e-01,7.4870666031763788e-01,
                                  3.8431548036227781e-01},
                                 {1.4947204591846142e-01,7.7638331382352910e-01,
                                  4.2773539808783390e-01,1.6567455088077221e-02,
                                  5.1902443713582724e-01,4.4013395665516430e-01,
                                  3.9854723372453549e-01},
                                 {2.4745215008473442e-01,4.4689097747524253e-01,
                                  1.6544864014344218e-01,8.8455805763353534e-01,
                                  5.4171053202870634e-01,4.5064772592825997e-01,
                                  1.7145452395051319e-01}},
                              
                                {{8.0567574866213798e-02,9.6030060383805027e-01,
                                  2.4227928607109972e-01,3.2307252424132193e-01,
                                  4.4596474440115219e-01,6.4496579471739079e-01,
                                  3.0185704148840475e-02},
                                 {4.4039934310510920e-01,1.5960012907891752e-01,
                                  7.1508109808895182e-01,2.0636877596040604e-01,
                                  6.1146575182843999e-01,5.9003207237484234e-01,
                                  2.5564914851977538e-02},
                                 {4.8817493620480512e-01,7.7970900366991891e-01,
                                  4.0025374738329467e-01,9.2103700258069698e-01,
                                  7.9267300952892827e-01,5.7949689428289630e-01,
                                  4.0580858429700051e-02},
                                 {6.6121646148379964e-01,9.9469921050999754e-01,
                                  8.4429031826060252e-01,3.2338821960428932e-01,
                                  8.1075426443920184e-01,5.6569925111916486e-01,
                                  9.1494105875237575e-01},
                                 {5.7386256068212183e-01,9.0812814517172757e-01,
                                  6.9111922505845824e-01,3.4699150202637197e-01,
                                  7.7853509616948802e-01,5.6868823186974393e-01,
                                  6.4485196581658188e-01},
                                 {2.9166539949143222e-01,4.5390701690333946e-01,
                                  3.8108497054621138e-01,9.6399049924119473e-01,
                                  1.0934012771405266e-03,6.9315634568548457e-01,
                                  8.9240960224383281e-01}},
                              
                                {{2.9054335145827737e-01,1.4209099469505437e-01,
                                  8.0210359926802000e-01,8.5020044304347708e-01,
                                  9.0257954574911903e-01,9.6106911948237883e-01,
                                  7.3419110506653484e-01},
                                 {3.6060930462780461e-01,3.0232220696187595e-01,
                                  7.8883253078008830e-01,3.5706026372835575e-01,
                                  8.8142387449493220e-01,6.1324609592514623e-01,
                                  9.8949373987758171e-01},
                                 {3.1724198743242271e-01,5.0651030004720521e-01,
                                  9.2358131476248961e-01,3.9345510267589634e-01,
                                  5.3695740475721687e-01,9.9447086782783523e-01,
                                  4.7403784128705906e-01},
                                 {1.9328719219469448e-01,9.9942503564512430e-01,
                                  3.3437068238544421e-02,8.3309610830290748e-01,
                                  5.3905930892238940e-01,4.6069376031861631e-01,
                                  5.3154392293829889e-01},
                                 {2.0707531550228919e-01,5.7601901922931109e-01,
                                  3.4661332750772655e-02,3.0105498421323273e-01,
                                  3.8688703636913024e-01,7.2417367430088364e-01,
                                  2.9624817998857467e-01},
                                 {7.8322564896349989e-01,2.8772423183220486e-02,
                                  3.9701143147273565e-01,4.3922395381065582e-01,
                                  4.4162349869178119e-01,5.8317044748615487e-01,
                                  5.3710579514059187e-01}},
                              
                                {{9.5625518990739411e-01,5.9669175016759568e-01,
                                  1.5966180422688592e-01,5.3111338755102366e-01,
                                  4.5287666635748436e-01,9.6704229170526423e-01,
                                  4.2207766320194429e-01},
                                 {7.9577555376032949e-02,5.0986552836057797e-02,
                                  2.3486554485417521e-01,5.1726274116165549e-01,
                                  5.9514679105866464e-01,9.2993765906599923e-01,
                                  3.6008507408040247e-01},
                                 {2.9302511380628227e-01,6.8496659814249017e-01,
                                  8.6266747119578957e-01,9.2157419356231429e-01,
                                  7.4258505249154061e-01,2.9342187584177282e-02,
                                  1.9531649225221814e-01},
                                 {8.6592070941436616e-02,9.7690043243034774e-01,
                                  8.6164137679676334e-01,6.6559530088775709e-01,
                                  6.5177425541495360e-01,6.6610876709551914e-01,
                                  8.0090091308229328e-01},
                                 {9.2878259416707543e-01,9.3962531600966104e-01,
                                  1.9618194589426108e-01,1.6497196448184703e-01,
                                  5.6844642263396283e-01,9.8819050314232759e-01,
                                  5.5783497194404308e-01},
                                 {5.4945951549258631e-02,1.9126225541161046e-01,
                                  4.8973795718864122e-01,1.7899459505956783e-01,
                                  2.3415700277283857e-01,9.5650676617494290e-01,
                                  7.1378282742617138e-01}},
                              
                                {{7.8850077909272853e-01,7.3318069799028551e-02,
                                  1.7298322242239061e-01,5.8686645739143284e-03,
                                  4.9129184016495764e-01,5.0887781165424106e-01,
                                  5.4281120468402810e-01},
                                 {6.3354765676001401e-01,9.5898336572580301e-01,
                                  3.9541126343986477e-01,6.3294773882538735e-01,
                                  4.5791959850095632e-01,6.5041422471881072e-01,
                                  2.1963574516024731e-01},
                                 {8.3547838836587973e-01,7.1580008801273509e-01,
                                  7.1965083860940426e-01,5.2204976030897798e-01,
                                  6.5260655379302146e-02,9.8719920685134133e-03,
                                  7.2253759805118722e-01},
                                 {8.1286975366989589e-01,9.8745458579537104e-01,
                                  6.3657473089934935e-01,7.4000716398592670e-01,
                                  7.5859226979550820e-01,9.4332048941825675e-01,
                                  6.2513918102540711e-01},
                                 {6.3835048767291502e-01,7.6179819232885648e-01,
                                  3.2901376076578992e-01,8.5745666774295781e-01,
                                  1.8711499439200774e-01,2.0234116072499708e-01,
                                  1.2649224049540797e-01},
                                 {2.7434465795701712e-01,8.3036980091354362e-01,
                                  1.4584020589157154e-01,9.3579734458618269e-01,
                                  3.6387432272906084e-01,9.6112661166779867e-01,
                                  7.6418007111042696e-01}}},
                              
                              
                               {{{6.1076707503273453e-01,3.8359197725176486e-01,
                                  3.8428316573307886e-01,9.0071759258997330e-01,
                                  3.0684757187847522e-01,8.3168855948559994e-01,
                                  4.4433149635084479e-01},
                                 {3.3421301825831118e-01,5.3973281472898960e-01,
                                  1.7596545620171766e-02,9.9449057816762010e-01,
                                  5.8636764940774089e-01,9.4897456162505567e-01,
                                  3.3911875097475808e-01},
                                 {9.4839381148459512e-01,4.6566478743057793e-01,
                                  7.8471843070620484e-01,6.0734529169186857e-01,
                                  2.2772084269786841e-01,3.1331924481214601e-01,
                                  9.1709179859214252e-01},
                                 {9.2492154409504979e-01,2.7423726632763412e-01,
                                  1.7314270086318961e-01,6.1324407771581502e-01,
                                  6.0827000401796605e-01,4.6034718666327090e-01,
                                  3.5320987369510248e-01},
                                 {3.2766735672915293e-01,5.5867383310786267e-01,
                                  1.7284783026735762e-01,9.2487264645742540e-01,
                                  8.4923912842785287e-01,5.2716847732942451e-01,
                                  2.0901292533154014e-01},
                                 {6.7263072317031536e-01,7.1262811643549018e-01,
                                  3.0274373530363785e-01,6.6614421171064386e-01,
                                  1.7497021976067040e-01,6.4862011664973174e-01,
                                  4.6725179674120931e-02}},
                              
                                {{2.2509660655677810e-01,3.4957694541202455e-02,
                                  3.5388436908003196e-01,5.1933528688779684e-01,
                                  4.2793397449854531e-01,8.1118961442508986e-01,
                                  4.2501230147846147e-01},
                                 {4.0162069776730280e-01,9.9567743331902969e-01,
                                  6.6705731709010618e-02,3.9419309644974188e-01,
                                  8.4941693224358283e-01,5.2288553304657037e-01,
                                  3.4396153851953160e-01},
                                 {7.7828928033961386e-01,3.1433331283636079e-01,
                                  4.2841549918244071e-01,2.6470748092421148e-01,
                                  5.4804998141769290e-01,5.8687079265459707e-01,
                                  4.5050690134147231e-01},
                                 {5.2363866854273744e-02,9.2590960642786868e-01,
                                  4.3373604632693163e-01,3.2823926723803853e-02,
                                  9.4285875490627502e-02,4.5862188714304986e-01,
                                  5.4715167752957716e-01},
                                 {3.7678171768195456e-01,3.7483005458432017e-01,
                                  8.8965998077967434e-01,5.2063359998717840e-01,
                                  5.6836964211035568e-01,5.0896388650979862e-01,
                                  1.2928786261552339e-01},
                                 {2.4301064444558185e-01,4.7225055091924484e-01,
                                  1.1465844482109788e-01,4.9208149802855805e-01,
                                  4.0251653337110938e-01,7.2408150865885634e-01,
                                  6.7678861340038388e-01}},
                              
                                {{2.5848263200399124e-01,9.6693096377858401e-01,
                                  4.4304473213371609e-01,3.7581217114303500e-01,
                                  6.4250814521208643e-01,5.8446930232498173e-01,
                                  9.4039512336605957e-01},
                                 {2.3916122864573452e-02,7.3892740508624777e-01,
                                  7.1016937693251547e-01,5.6167576546078213e-01,
                                  4.7948438178213593e-01,7.8574235873060239e-01,
                                  6.4801049015359213e-01},
                                 {1.5484239533213295e-01,6.1838232882947297e-01,
                                  7.3422379302052643e-01,9.7905662446131247e-01,
                                  4.7853571442231224e-01,4.9286256906438708e-01,
                                  9.3841647347324553e-01},
                                 {8.9077129006476452e-01,8.1385614168999409e-01,
                                  4.3143029967144519e-01,5.1179283560400268e-01,
                                  3.7630079408920825e-02,8.9003496254669678e-01,
                                  1.1606108149057048e-02},
                                 {7.8814666382474907e-01,2.6497040251421100e-01,
                                  6.0326361378055771e-01,2.4429471843697237e-01,
                                  5.1267958414631798e-01,1.1452173603022886e-01,
                                  3.9665692203759184e-01},
                                 {5.5177103756008539e-01,4.4564830112167964e-01,
                                  3.6711776144940511e-01,7.9671759332279413e-01,
                                  1.1560051136386040e-01,6.9660056830044625e-01,
                                  8.2020635428891009e-01}},
                              
                                {{3.5359038711726487e-01,1.9739874647981437e-01,
                                  4.7657487064173520e-01,9.0982739773277033e-01,
                                  3.8908350116482593e-01,5.9985769370096975e-01,
                                  1.8404666060638963e-01},
                                 {4.8501094056397021e-02,6.1011186714166588e-01,
                                  3.7244641724248151e-01,2.9333566026183899e-01,
                                  8.3484996637630382e-01,7.7487530880631816e-01,
                                  2.0460123674902053e-01},
                                 {6.2392978611820082e-01,7.5775949221267613e-01,
                                  3.9015615552292726e-01,7.1844485442218753e-01,
                                  1.0160781161857269e-01,2.5347497091495685e-01,
                                  7.7631507496229279e-01},
                                 {7.6291533707972481e-01,4.3358935089462625e-01,
                                  7.4731737673624210e-01,4.5639270429723711e-03,
                                  4.7741706902717485e-01,2.8020875138492962e-01,
                                  5.8432494095673593e-01},
                                 {5.2932679138212479e-01,9.8406578700095793e-01,
                                  8.3051281311371505e-01,6.6023364405442508e-01,
                                  5.4110810641805118e-01,6.0178704155253204e-01,
                                  8.4672070733387006e-01},
                                 {7.1238209261923813e-01,7.2015741353630602e-01,
                                  2.6827416028892936e-01,7.3101350005749444e-01,
                                  3.2526630589912919e-01,8.8064614673002317e-01,
                                  8.2859202541759613e-01}},
                              
                                {{5.2001103464917720e-01,5.7376390837793667e-01,
                                  6.3498354162942650e-01,3.2437536013017321e-01,
                                  8.1501184834491336e-01,5.7869556040096681e-01,
                                  2.3631892108973318e-02},
                                 {3.0337411235851519e-01,4.7896875124898353e-01,
                                  3.2276296576213326e-01,4.3726468867312862e-01,
                                  4.6550880755896862e-01,4.6536530437137325e-01,
                                  2.2068971595982090e-03},
                                 {9.2165310513676380e-02,2.6237617305912353e-01,
                                  4.0033658680680506e-01,2.3462566238451732e-01,
                                  9.3318510756862505e-01,1.9900422650355254e-01,
                                  5.8176947437240756e-01},
                                 {9.7015698802935779e-01,5.1634346659362651e-01,
                                  9.4387206899139731e-01,9.8349407776134312e-01,
                                  5.0048250596864097e-01,7.1186007703868148e-01,
                                  7.3227970178015600e-01},
                                 {4.6585299131542801e-01,8.9260854408116586e-01,
                                  9.4799972246939757e-01,7.2969213196525184e-01,
                                  1.7167001042168806e-01,9.4215702747094121e-01,
                                  1.7483271642679588e-01},
                                 {1.7428280717337596e-01,6.8033871912212152e-01,
                                  7.2734539869025117e-02,2.4425749675865482e-01,
                                  5.3032426006986000e-01,2.9217222937621756e-01,
                                  8.2892418339150042e-01}}},
                              
                              
                               {{{7.9134837978586370e-01,9.2680026223008305e-02,
                                  6.2459324597824217e-02,4.7406402779839207e-01,
                                  3.1706503861311741e-01,5.7466757692469250e-01,
                                  4.6420501260836600e-01},
                                 {1.3209211080402516e-02,2.3431750532916629e-01,
                                  5.2380847930408869e-03,2.9202922545220389e-01,
                                  5.4461114119454668e-01,3.7100778702206960e-02,
                                  4.4162620449954937e-01},
                                 {3.2718438184570253e-01,6.9961894995286655e-01,
                                  8.4624348195615740e-01,6.1248574271804102e-01,
                                  6.1903280981227626e-01,6.1813385167667523e-01,
                                  5.0757011042917932e-01},
                                 {9.5025919843808260e-02,1.1665526825393358e-01,
                                  5.4992791109625616e-01,2.9930744940541842e-01,
                                  9.7435548669253425e-01,9.3188881071434015e-01,
                                  8.4627849575017788e-02},
                                 {5.2471669799660925e-01,9.5139267057782861e-01,
                                  7.8934677040332812e-01,2.1744812660182911e-01,
                                  6.1474263352101344e-01,3.7751175316903929e-01,
                                  4.5974481611596463e-01},
                                 {1.6532658753085483e-01,1.2583877762226303e-01,
                                  7.0588333431798844e-01,8.5969436911387487e-01,
                                  5.7552889968899046e-01,2.7367653254690039e-02,
                                  3.4858340602273918e-01}},
                              
                                {{9.0369604400155146e-01,7.7490835268540226e-01,
                                  2.9829148905437752e-02,9.7203340625579404e-01,
                                  7.4264653467915887e-03,8.2160391391721266e-02,
                                  7.3521937776065627e-01},
                                 {7.6344420613513331e-01,8.5399866991240103e-01,
                                  8.6128470868124252e-02,4.8409796627116175e-01,
                                  1.2274147353191001e-01,4.4088751982171270e-01,
                                  7.8035001225611655e-01},
                                 {7.3877858849829670e-02,5.1385738995801933e-01,
                                  8.8018033184201649e-02,3.6673858095275902e-02,
                                  3.8159287336977710e-02,4.1853029259529184e-01,
                                  6.6254849858771037e-01},
                                 {7.7937123279492149e-01,9.2834288658544895e-01,
                                  9.7701326832739643e-01,9.3670579414876864e-01,
                                  3.1608539976863570e-01,3.5888747121441555e-01,
                                  5.4798949612533443e-01},
                                 {2.0934306791754620e-01,2.8807971009398681e-01,
                                  5.9331622708041432e-01,1.3005894191921263e-01,
                                  3.9084022598277390e-01,1.9899320452893099e-01,
                                  4.2745824905590935e-01},
                                 {8.9569758378493691e-01,5.1583856844257070e-01,
                                  3.6320737082006194e-01,8.3242451519538629e-01,
                                  4.4371637969854805e-01,1.9085265578594002e-01,
                                  4.9163746371916817e-01}},
                              
                                {{3.3067427240721792e-01,3.8678834826280029e-01,
                                  7.2657935903102078e-01,4.9323800313123001e-02,
                                  3.1867536986316114e-01,1.3536705856092746e-01,
                                  9.5739893849286528e-01},
                                 {1.1029936813203201e-01,5.7702918384860258e-01,
                                  4.6584963136687163e-01,3.0000045565299227e-02,
                                  6.3141862321779096e-02,8.5624864091189012e-01,
                                  5.0440925679234105e-01},
                                 {6.0680292299488581e-01,9.1299725730649484e-01,
                                  1.5919889681262389e-01,5.4150543488125080e-01,
                                  1.5765332393265807e-01,9.7973263795856402e-01,
                                  4.1474534882312053e-01},
                                 {2.8000699373569993e-01,8.2507382022248743e-01,
                                  8.8491124095289997e-01,9.6473834332757946e-01,
                                  3.7076260691040885e-01,9.9296573515404940e-01,
                                  2.1837912124459069e-02},
                                 {1.4462802569936273e-01,5.1722094788119555e-01,
                                  5.0384857415635365e-02,7.3728186934729001e-01,
                                  7.6448894115903587e-01,7.7450233648206546e-01,
                                  1.4820165081593273e-01},
                                 {6.1371861373816683e-01,2.8297197114358374e-01,
                                  2.3158467654458637e-01,8.4672829072758404e-01,
                                  9.3517377398751300e-01,4.6522266893640374e-01,
                                  5.0283407389201229e-01}},
                              
                                {{3.1942416952664510e-01,9.1029987121835321e-01,
                                  8.4198652164617493e-01,6.6427013463253437e-01,
                                  2.3231279610918398e-01,7.7400531376211024e-01,
                                  6.5714781216255702e-01},
                                 {6.7160991761624578e-01,6.8623123803844521e-01,
                                  4.2431670319029424e-01,2.3141040886644970e-01,
                                  7.6065062423778007e-01,3.5791662570011751e-01,
                                  5.7103283767003332e-01},
                                 {9.9695623861571947e-01,1.2563503118767361e-01,
                                  4.2547312003072202e-01,5.7055832034933973e-01,
                                  6.2026983423959192e-01,9.1425658493038520e-01,
                                  5.3567285476935345e-02},
                                 {5.7181274520734449e-01,5.5364613294579157e-01,
                                  5.7989941342154960e-01,8.8497744294844694e-01,
                                  5.4991755947146526e-01,4.5782337651915017e-01,
                                  8.6012196367335136e-01},
                                 {5.7270593881626486e-01,5.9757942116828333e-01,
                                  6.2889712565831402e-01,9.5777599027256699e-01,
                                  8.3387234390447840e-01,5.2782657005493550e-01,
                                  4.5842655195029614e-02},
                                 {9.8419288078463596e-01,6.4319404588821871e-01,
                                  3.3250876693616316e-01,1.9355009597729023e-01,
                                  9.3753547893654565e-01,6.3091111960227320e-03,
                                  9.0339093520633651e-01}},
                              
                                {{2.2570271134057518e-02,1.3809341378787865e-02,
                                  1.6353607470636988e-01,9.2168506917506776e-01,
                                  5.5243756065946104e-01,5.5990934460259034e-01,
                                  8.9501877041906608e-01},
                                 {8.1927565933168855e-01,9.9548002472297115e-01,
                                  7.7998798537630287e-01,7.4051027043744355e-01,
                                  7.4904335819066814e-01,4.6907578486660417e-01,
                                  5.0715716672601907e-01},
                                 {8.6807025622770251e-01,6.5969909433020169e-02,
                                  4.3415479513315258e-01,6.5882917213032566e-01,
                                  5.2368460750415913e-01,5.2071836381637759e-01,
                                  3.4435829357973835e-01},
                                 {2.8513110132856767e-01,4.1484168490156581e-01,
                                  6.7886151546292628e-02,1.1215332316320870e-01,
                                  8.7523193345240013e-01,6.4353606884133552e-01,
                                  9.4243240336089074e-01},
                                 {2.2911869857308687e-01,1.1302587960272747e-01,
                                  6.7123164615842856e-01,3.6569464359823201e-01,
                                  9.6222095252110451e-02,9.0478201520613377e-01,
                                  6.2193852967380936e-01},
                                 {6.6069312453931894e-01,4.3692708670672165e-01,
                                  3.7012169056944022e-01,4.3813515910568512e-01,
                                  8.6968276533713706e-01,5.3836795614110633e-01,
                                  7.8706778396924948e-01}}}};
        // py_w
        xarray<double> py_w = {{{{9.2709634234865501e-01,2.1261209335148368e-01,
                                  4.4721318085972706e-01,9.3781897712248130e-01,
                                  9.4765070761140213e-01,7.4222578639419667e-01,
                                  5.9988710850679805e-01},
                                 {4.4123875049244066e-01,5.3892580130014767e-01,
                                  6.8620355038890402e-01,4.6397614841360513e-01,
                                  9.4222241559707809e-01,1.2224417235507756e-01,
                                  1.0971429346848893e-01},
                                 {6.4896808257077121e-01,7.0805803927290678e-01,
                                  5.8916202959347630e-02,1.5121926263857732e-01,
                                  8.5158635979875164e-01,8.6154920378684063e-01,
                                  9.8546033976265390e-01},
                                 {4.5487723359866006e-01,8.1728566262661229e-01,
                                  3.8819034577571454e-01,4.7160502626517731e-01,
                                  5.5990189873302132e-01,1.1469210228656035e-01,
                                  9.9986714695256618e-01},
                                 {5.5162372275237848e-01,6.5722477390139922e-02,
                                  1.7146489527716013e-01,8.1880482749077110e-02,
                                  3.3524571219128441e-01,8.4001963155475989e-01,
                                  1.7180024366045266e-02},
                                 {2.4140798798458096e-02,9.9422146823023738e-01,
                                  2.9431481278394256e-01,3.9174517446231483e-01,
                                  4.5975810007109585e-01,2.1358365255491019e-01,
                                  7.7498248349804477e-01}},
                              
                                {{5.0296896273477110e-01,8.4256258520613725e-01,
                                  5.5959953857695721e-01,4.2966893696176556e-01,
                                  7.5981052710108077e-01,3.0905327660529569e-01,
                                  1.4817806185089277e-01},
                                 {4.6414890802132214e-01,8.5832827846439064e-01,
                                  5.9468313344148649e-01,9.1283746858297365e-01,
                                  8.3982033585186322e-01,7.9936970605199442e-01,
                                  9.2416898045398632e-01},
                                 {7.3338404042592598e-01,8.6688689619175674e-01,
                                  7.5109846553839510e-01,2.9751362303468809e-01,
                                  6.3394703070655689e-01,9.9834358850061600e-01,
                                  9.7868835032975643e-01},
                                 {8.7188591553327521e-01,2.2874407625854265e-01,
                                  4.9485711218448936e-01,7.4385209858675228e-01,
                                  7.0710272842818045e-01,3.6744249394488648e-01,
                                  7.8840852437504472e-01},
                                 {7.9601128845926850e-01,8.9179826571380660e-01,
                                  5.5383584855098855e-01,9.7251370599952036e-02,
                                  4.8131163516272657e-01,2.7722159165950255e-01,
                                  8.2445829940911763e-01},
                                 {4.1260935769548213e-01,9.1648788595908759e-01,
                                  7.5017134763357252e-01,5.3933148294302413e-01,
                                  1.9502057449889043e-01,3.1438541815694376e-01,
                                  1.9115812521118247e-01}},
                              
                                {{7.0118197557630113e-01,7.5194117970182162e-02,
                                  5.7544591337911055e-01,8.8184654906108939e-02,
                                  5.2670309023590034e-01,9.6066856464846939e-01,
                                  2.3439477021696531e-01},
                                 {4.4630736039781149e-01,5.1941238734667927e-01,
                                  6.0480012511285874e-02,2.9591557220152342e-01,
                                  4.7261662424896378e-02,3.2894274649359212e-01,
                                  6.5358066732871256e-03},
                                 {8.7523063970514015e-01,4.4256842393059326e-01,
                                  6.0144155847013470e-01,8.5049177646441465e-01,
                                  4.5849976812252768e-01,3.9321812377902554e-01,
                                  2.2316612301801897e-01},
                                 {9.2427644037151269e-01,1.9597326721893082e-01,
                                  9.4508204218260849e-01,8.0407334229980321e-01,
                                  4.7348070937789810e-02,7.0586866801998183e-01,
                                  9.4389746428455423e-01},
                                 {1.8752849370474967e-01,4.6605730187230965e-01,
                                  2.3145215698483557e-01,5.4886683371829814e-01,
                                  2.4792507755050042e-02,9.2736538671758439e-01,
                                  3.1634158576166582e-01},
                                 {4.9463912672778199e-01,9.5541974059617318e-01,
                                  2.2000110005395823e-01,1.2095787212947617e-01,
                                  8.2381411772179480e-01,8.5456857902347483e-01,
                                  2.3520583706282960e-02}},
                              
                                {{9.8547999881483705e-01,3.2026458651874257e-02,
                                  9.0005122428980888e-01,5.6549883389020783e-02,
                                  1.1464838763645469e-01,6.0234406054379042e-01,
                                  3.5679672447706545e-01},
                                 {8.0783707221108314e-01,1.5559413452177273e-01,
                                  3.9339059468366544e-01,7.3687283031066853e-01,
                                  6.1870120070278312e-01,1.5521244003693824e-01,
                                  9.4353804188545054e-01},
                                 {6.3028582343208839e-01,1.0928397760940189e-01,
                                  1.8665553998867956e-01,4.8352934836888661e-01,
                                  7.7642217567343752e-01,5.3680360529886739e-01,
                                  2.2441711102886286e-03},
                                 {7.2478495933728537e-01,9.8510656180924927e-01,
                                  4.2441261621851767e-01,9.7735661940006180e-01,
                                  6.7162684445422660e-01,8.7606671307266737e-01,
                                  6.2605715496061753e-01},
                                 {9.3038677621475563e-01,1.0415213630371234e-02,
                                  9.8607989021628617e-01,9.0426477550066087e-01,
                                  9.9369924164786305e-01,7.3823658638250789e-01,
                                  6.3441538197773284e-01},
                                 {6.9087610933122912e-01,3.7729558786935524e-01,
                                  2.7390937919251357e-01,4.4110267920317692e-01,
                                  1.8028626409334048e-01,1.9921217565914262e-01,
                                  4.3738529961020034e-01}},
                              
                                {{5.8948346843221489e-01,6.5896456842299345e-01,
                                  5.2860746623734012e-01,8.0803204369603299e-01,
                                  9.0986525137070484e-01,5.2173428204699501e-02,
                                  8.8481553135082647e-01},
                                 {7.7554723673976977e-02,8.2288772388849607e-01,
                                  4.7756334186270266e-01,4.0109997713923584e-01,
                                  7.8077532960858165e-01,5.8034317976406047e-01,
                                  4.3083539989351283e-01},
                                 {9.1148907441527749e-01,3.1943282697735964e-01,
                                  8.3040284180550628e-01,9.4217308283820822e-01,
                                  8.4999315077701310e-01,2.2173320215966885e-01,
                                  3.4117075038074329e-01},
                                 {5.6996520935517636e-01,8.7940548754848680e-01,
                                  3.1766672871814405e-01,5.9968652868520400e-01,
                                  8.4059830154591320e-01,6.4337815329506698e-01,
                                  3.0811068007545261e-01},
                                 {7.1138532579320113e-01,3.2689673749917159e-02,
                                  1.8695954475154031e-01,6.4425149471472265e-02,
                                  3.8484260489616418e-01,7.3903516794727964e-01,
                                  6.3424342270239631e-03},
                                 {1.9428720967697011e-01,4.7177351953701818e-01,
                                  4.0039210030621930e-01,1.3720012771442480e-01,
                                  6.3443487875481952e-01,9.5658414643161827e-01,
                                  9.2579780736661910e-01}}},
                              
                              
                               {{{9.7595728434353124e-01,2.3167523023018466e-01,
                                  6.2005838770920696e-01,6.0882430627431594e-02,
                                  5.5522117881212174e-01,6.4985644846932944e-01,
                                  8.8581648867049090e-01},
                                 {7.7893534266039477e-01,3.4752705817731522e-01,
                                  1.0371342297961106e-02,6.7356893520407990e-01,
                                  9.4617301661423125e-01,4.3975357765493206e-01,
                                  8.9142222050063380e-01},
                                 {5.4572270310179372e-01,1.2521907670603138e-01,
                                  9.9084185663515290e-01,3.0645745923792789e-01,
                                  6.9244226015741717e-01,4.9641540045807531e-01,
                                  6.5731079829296679e-01},
                                 {7.1569695194694627e-01,7.3928245257757463e-01,
                                  4.7680834587882082e-04,1.1312266404293270e-01,
                                  3.6259907557092030e-01,6.9624206132153754e-01,
                                  7.1985518647999036e-01},
                                 {4.3197232208196934e-01,1.9142541294721849e-01,
                                  1.8532294414159500e-01,4.9773725441397831e-01,
                                  6.7548639427846346e-01,8.3918725145577677e-01,
                                  4.8967060051387401e-02},
                                 {5.7470904775736420e-01,9.7124168516290466e-01,
                                  4.4491131267657025e-02,6.0459800969097310e-01,
                                  9.7241443636973934e-01,3.0317997151461251e-01,
                                  8.1159683045014819e-01}},
                              
                                {{5.8329429566265234e-01,7.8119471742941482e-01,
                                  9.2264152876241001e-01,7.5424316736469621e-01,
                                  7.6067521293063312e-01,4.2928604364873801e-01,
                                  2.6451085447220613e-01},
                                 {6.0558988621958176e-01,7.9279486058793835e-01,
                                  1.2778100218157284e-01,8.5475218668892672e-01,
                                  4.6611711552351198e-01,6.7173024948361393e-01,
                                  5.2483492276194676e-01},
                                 {1.3954302784432171e-01,8.4015342269880144e-01,
                                  8.3475205489043491e-01,6.8113378972492755e-01,
                                  6.8575871020080426e-01,4.3766885667413802e-01,
                                  1.4670192006686000e-01},
                                 {3.5554835088896963e-01,6.3483549189821220e-01,
                                  2.5775295716296709e-01,6.8975160847743000e-01,
                                  6.2661484744092943e-01,6.7950424214918936e-01,
                                  6.3537959874600736e-01},
                                 {3.2490403409584623e-01,7.5315025465155139e-01,
                                  6.0585496446812337e-01,9.2836052191767426e-01,
                                  2.0670921093959771e-01,4.9033374287965947e-01,
                                  3.4181347131004747e-01},
                                 {7.7738424712191467e-01,8.6637550614363257e-01,
                                  2.2531930367256758e-02,4.0569690717977225e-01,
                                  4.1939831203136257e-01,8.2952008662832810e-02,
                                  2.4246375400732556e-01}},
                              
                                {{7.8157304789965942e-01,5.0997189872991400e-02,
                                  4.4713063941520925e-01,8.8112037542134436e-01,
                                  2.9543312334580318e-01,8.3587998285407950e-01,
                                  1.2853479603928253e-01},
                                 {2.1082419509651851e-01,3.2504208143640900e-01,
                                  6.0743990849324681e-01,7.9189660916845428e-02,
                                  6.5552884606794570e-01,6.2129812695691067e-01,
                                  9.1326035068989797e-01},
                                 {3.2756630457397518e-01,4.9728328974402236e-01,
                                  5.3585960576743885e-01,7.2539673871658283e-01,
                                  3.4630569080239137e-01,4.5462921153926050e-01,
                                  9.5647447467370783e-01},
                                 {8.0891419052731228e-02,3.1412152314216113e-01,
                                  3.8671603956499601e-01,3.9775725042554633e-01,
                                  1.2112801257968964e-01,4.3388123152090396e-01,
                                  3.5386795630991785e-01},
                                 {7.7067271130028658e-01,9.7685208823503722e-01,
                                  6.0885066664394794e-01,6.0835948833974962e-01,
                                  9.2707304396993950e-01,4.1322254214600129e-01,
                                  8.6206944218298509e-01},
                                 {6.9488126489204793e-01,4.3880085654149370e-01,
                                  6.4031797976265681e-01,5.1019962070960301e-01,
                                  7.6509895327320177e-01,2.5614652208447963e-01,
                                  1.1722241621491614e-01}},
                              
                                {{8.2045090065584025e-01,9.6276153715938728e-01,
                                  3.8590284105406969e-01,6.9053087281509451e-01,
                                  3.3322342935019322e-01,9.0407659402067519e-01,
                                  3.4595983039658118e-01},
                                 {2.1315981466385603e-01,3.7210561381171570e-01,
                                  3.4790880942180580e-01,4.9357580110291321e-01,
                                  7.9415232679476877e-01,6.2509446889565179e-01,
                                  7.1161394926680932e-01},
                                 {8.0259929614266079e-01,3.2427318581744491e-01,
                                  8.0580183291006280e-01,3.9098040267797585e-01,
                                  6.5774666809794036e-01,9.7785409065752360e-01,
                                  4.4336404918110406e-01},
                                 {1.0134072418771667e-01,1.2971049735595408e-01,
                                  5.0308431044517965e-01,9.8076849428519031e-01,
                                  4.8067167124182808e-01,7.8438927242917234e-02,
                                  6.3555605790230629e-01},
                                 {6.9097922344677509e-01,8.4555701338954958e-01,
                                  6.6002423609676120e-01,8.6665757992187364e-01,
                                  9.1794983188657364e-01,8.1545031800269319e-01,
                                  4.0522715115559171e-01},
                                 {8.7156704062319468e-01,1.5637218604128800e-01,
                                  5.8203437173468453e-01,1.8517148184481258e-01,
                                  5.7942725297933617e-01,2.7478565867633298e-01,
                                  8.8590585092355956e-01}},
                              
                                {{5.3021802616397740e-01,9.3615431551676509e-01,
                                  2.2702187790535888e-01,2.5991826304998378e-01,
                                  4.2980058840645041e-01,8.8776618884868597e-01,
                                  3.8408493733573768e-01},
                                 {9.7806294534524285e-01,9.0394707527710316e-01,
                                  9.0525948110442356e-01,7.2599956309687130e-01,
                                  1.2799357714781268e-01,1.9093107747125693e-04,
                                  5.7051203295404274e-01},
                                 {8.1946325279459642e-01,5.1708068071833213e-01,
                                  7.9267313625426761e-01,1.8872954110888751e-01,
                                  9.5475073979067349e-01,7.9175570168329823e-01,
                                  8.7229290464085185e-01},
                                 {4.9989002165852392e-01,1.2209356342341737e-01,
                                  8.8125749327439706e-01,5.0951107011921737e-03,
                                  3.2792049782789023e-01,4.8674893944212816e-01,
                                  3.1060538685352623e-01},
                                 {1.2680631827271327e-01,4.5854250012201259e-01,
                                  5.5478239973852994e-01,1.6272107593863561e-01,
                                  5.1376336216002805e-01,4.2971986186348188e-01,
                                  2.9699224537375135e-01},
                                 {9.2274565531776898e-01,4.5984259671416761e-01,
                                  8.3473669250774518e-01,9.2695125976097226e-01,
                                  9.7254784547251716e-01,5.0081515232052609e-01,
                                  8.6763440701315331e-01}}},
                              
                              
                               {{{9.8407096723240484e-01,9.2469312742427057e-01,
                                  8.7176415973157217e-01,7.4336730336914891e-01,
                                  3.6036405240802871e-02,2.2932156571374052e-01,
                                  3.0113957101526778e-01},
                                 {1.9841082533466503e-01,9.8057391728063059e-01,
                                  9.7916813468188502e-01,7.7052739984124319e-02,
                                  1.7396176783547845e-01,3.3257395814647550e-01,
                                  4.2829942849640312e-01},
                                 {9.7838182343743052e-01,9.2078392462202185e-01,
                                  9.6239513098468676e-01,5.6985910872992029e-01,
                                  6.9596467985504784e-01,4.5058827187659589e-01,
                                  4.4883593163738367e-01},
                                 {3.0593080761483593e-02,2.2154789701110567e-01,
                                  5.2305917728275397e-01,1.7741844011426955e-01,
                                  1.5942658268895027e-01,8.7867582945564449e-01,
                                  7.2306635300260724e-01},
                                 {2.1681410824873282e-01,4.5904707103959674e-01,
                                  4.4057032065485213e-01,4.8279498829336209e-01,
                                  3.9224059374776421e-01,8.7275963416175606e-01,
                                  1.3244049890259080e-01},
                                 {9.6613111719008171e-01,1.6253061390368195e-01,
                                  5.7011666128995164e-01,2.0119616594567513e-01,
                                  9.8200879039370326e-01,1.4888223229354502e-01,
                                  8.6974549024266867e-01}},
                              
                                {{1.6601368802156069e-01,2.9109067702508185e-01,
                                  6.6268264085829165e-01,3.3282616481992877e-01,
                                  1.9888915869671131e-01,4.8794577298904251e-01,
                                  1.3603078920531364e-02},
                                 {8.5646559843595804e-01,6.6422635625084325e-01,
                                  2.5361608535119040e-02,5.3202396176117450e-01,
                                  2.5531778557890306e-01,9.7062817470393092e-01,
                                  2.2642060293794830e-01},
                                 {7.8463099510922540e-01,4.2304374535089173e-01,
                                  9.7016875946731029e-02,5.5697551375994692e-01,
                                  7.0552495306053187e-01,5.3084156151412165e-01,
                                  6.4447088105536954e-01},
                                 {7.2846162758698618e-01,7.6798592473105787e-01,
                                  7.8477811834957556e-01,3.8482977503570293e-01,
                                  2.0483657654214937e-01,5.2837588250906853e-01,
                                  4.0069326964546959e-01},
                                 {3.2880612620642102e-01,3.7563769277342252e-01,
                                  9.1122897248281831e-01,9.2699589782363701e-02,
                                  9.9557220322658213e-01,9.6338513307114626e-01,
                                  4.6820097308511843e-01},
                                 {8.8648089895117554e-01,5.7700130930627158e-01,
                                  9.3476341058766588e-01,1.0248878011327789e-02,
                                  2.8201473145904410e-01,8.0612074968814096e-01,
                                  5.5309701727903893e-01}},
                              
                                {{8.6756477873593174e-01,1.0461287276261610e-02,
                                  4.7324335928104888e-01,1.8350092081083047e-01,
                                  4.5117253793514467e-01,3.4998273955367643e-01,
                                  4.4804504910024956e-01},
                                 {6.9786092863074212e-01,5.4631338498634674e-01,
                                  1.4236082273368367e-01,4.7883705735017157e-01,
                                  3.1760910046139090e-01,1.0617103470438483e-01,
                                  7.2831815442082326e-01},
                                 {6.0920954425582563e-01,8.0336207496309642e-01,
                                  4.9287647276204505e-01,4.6084997957145801e-01,
                                  8.5261183174351107e-01,7.6969969046559261e-01,
                                  6.6172485619347809e-01},
                                 {8.2871462663671547e-01,7.4709716652730052e-01,
                                  7.1537903357822852e-01,1.1120474743747344e-01,
                                  5.4899920142619840e-01,3.8513848274680595e-01,
                                  9.6872516240964657e-01},
                                 {7.6791490043635802e-01,4.3827794058508673e-01,
                                  1.1224074400222006e-01,2.8518644262562654e-01,
                                  7.4174781796094713e-03,8.1077607435161014e-02,
                                  3.8596033477989433e-01},
                                 {1.0654568708733259e-01,4.6122514810019377e-01,
                                  8.3385256165801325e-01,5.2057334766670738e-01,
                                  9.1751590135101757e-01,5.8189735442920476e-01,
                                  5.8087878117740188e-02}},
                              
                                {{2.6142677499223277e-01,6.2595137557068725e-01,
                                  1.6321635765675147e-01,7.9885004844071794e-02,
                                  2.2406599397863680e-01,1.0037017250988178e-01,
                                  6.5043850628525535e-01},
                                 {2.2315507048713867e-01,4.5387462509381304e-02,
                                  2.4527519178836643e-01,6.1811034502151874e-01,
                                  2.3247694025662902e-01,5.0732146495764840e-01,
                                  1.9479310450778287e-01},
                                 {3.7830336996993330e-01,1.4925610433889480e-01,
                                  1.4061076912818571e-01,3.5420642285329829e-01,
                                  7.3151047370276756e-01,7.5269417981981157e-01,
                                  7.4158595923026804e-01},
                                 {4.5421609335397461e-01,7.6853916491815966e-01,
                                  2.3693977837453228e-01,6.2432094402666283e-01,
                                  9.7861975201830176e-01,8.2578779702388239e-01,
                                  8.5093373069227352e-01},
                                 {5.6609882145416113e-01,6.5124482170527143e-01,
                                  1.4512242396706976e-01,6.5646717257694009e-01,
                                  6.2171516783916669e-01,9.0697196404977276e-01,
                                  4.3821208942756795e-01},
                                 {5.2229384128438716e-01,6.1209403744546464e-01,
                                  6.0119616032065615e-02,4.3652451361722122e-01,
                                  4.4999567584937283e-02,8.1097005010564271e-01,
                                  5.5616947552202134e-01}},
                              
                                {{6.8614971338615383e-02,5.7383364351729249e-01,
                                  4.1376387364634859e-01,6.9171654565490126e-01,
                                  4.6430763402383479e-01,2.8876416157669049e-01,
                                  5.7388114339807728e-01},
                                 {5.7669679484985537e-01,7.3811494955737633e-01,
                                  3.6653978106114238e-01,6.8366804914383705e-01,
                                  6.8677887773820112e-02,4.7546285100277164e-01,
                                  9.0623381058926977e-01},
                                 {3.4474759800583543e-01,7.3527889332193341e-03,
                                  5.3506188226077100e-01,9.1756449676739626e-01,
                                  9.7001306290217093e-01,4.0623680222085312e-01,
                                  9.3991809600332477e-01},
                                 {9.3742737453448188e-01,1.8247675091828397e-01,
                                  6.8346727175951805e-01,9.5638031204920504e-01,
                                  2.2154232643059346e-01,1.6489115325822179e-01,
                                  5.4578578766430363e-01},
                                 {5.2144296526632639e-01,8.6537837524548222e-01,
                                  3.6271172745923619e-01,4.7618214850250906e-01,
                                  4.6316081275469556e-01,1.0119370910990744e-01,
                                  5.0927991252944560e-02},
                                 {1.7690097108104919e-01,6.6118815401568376e-01,
                                  6.9145869585866171e-01,8.2164382935401248e-01,
                                  8.0307420495976833e-02,9.7102302224198855e-01,
                                  7.1928488956981118e-02}}},
                              
                              
                               {{{4.6589679387075666e-01,4.2421495999504233e-01,
                                  1.5400746889724137e-01,1.5333879217682034e-02,
                                  2.2366891822845680e-01,6.9182861245514971e-01,
                                  1.4474708101076428e-02},
                                 {5.0534934766883521e-01,3.0216381237133505e-01,
                                  7.3160552535938894e-02,3.0867665887987406e-01,
                                  4.3772699175800289e-03,8.4374643568690810e-01,
                                  2.7989734130572874e-01},
                                 {8.8736464372488388e-02,6.1089735698067649e-01,
                                  4.8457284377848131e-02,6.0978870601512214e-01,
                                  8.8549204792553404e-01,1.4935806286044229e-01,
                                  9.6784392119713203e-01},
                                 {3.8546207412540701e-01,6.3136247171359217e-01,
                                  9.3985547062907682e-01,5.5655921609671533e-01,
                                  7.1663368756040280e-01,1.8067559279263057e-01,
                                  4.4965379631269031e-01},
                                 {7.6692578778969178e-01,7.2319367491936759e-01,
                                  4.0782712807812138e-01,9.1867032684276406e-01,
                                  9.2594241129564048e-01,7.2637945673350834e-01,
                                  2.2351056361449484e-01},
                                 {4.1107417524022716e-01,7.8633378024207168e-01,
                                  8.0696199839337512e-02,6.6728478791451440e-01,
                                  6.9194106825517687e-01,1.6927071416996842e-01,
                                  4.6682304907698413e-01}},
                              
                                {{9.2342438149815997e-01,8.5713068335788734e-01,
                                  5.1079581046573730e-02,6.3763727127473924e-01,
                                  7.1147511074108194e-01,5.3046036308483191e-01,
                                  4.5788035274950745e-01},
                                 {5.6679622260914986e-01,4.2438315287120165e-01,
                                  2.5480972774117872e-02,8.7584972635535951e-01,
                                  8.5415970510497297e-01,6.2153511183834320e-01,
                                  5.7271448676438597e-01},
                                 {6.5184523733907884e-01,3.8399276948250960e-02,
                                  6.6497036617862659e-02,7.5467226610921623e-01,
                                  6.5953668661732823e-01,4.3928659935104608e-01,
                                  9.6942070310996276e-01},
                                 {9.9700257177333185e-01,8.0026405778607101e-01,
                                  8.2024864252276264e-01,4.3381361500015159e-01,
                                  8.0651755731361296e-02,4.4618519626411635e-01,
                                  9.1157163429060828e-01},
                                 {7.4503772872314278e-01,1.1035186977038269e-01,
                                  8.5590911071280884e-01,2.2107076451141539e-01,
                                  9.0903930832990321e-01,4.6157661185830778e-01,
                                  6.2688828045496348e-01},
                                 {7.5014811395275305e-01,4.9791586859622028e-01,
                                  6.5607994439788753e-01,5.1874079927810324e-01,
                                  8.7720051548225508e-01,7.3963802652148203e-01,
                                  1.4429800953172855e-01}},
                              
                                {{2.5119381870910940e-01,3.3075455565904854e-01,
                                  8.8893238097432159e-01,1.3977049622169613e-01,
                                  2.5211457154096961e-01,6.3408129261011281e-01,
                                  4.3020205062473127e-01},
                                 {3.4256608712061032e-01,3.6641696508622101e-01,
                                  7.1932872219691213e-01,7.0107307972429611e-01,
                                  4.3098759665449959e-01,9.2214638098887647e-01,
                                  5.8843636008682343e-01},
                                 {4.9713569621784814e-01,4.2785281080577375e-01,
                                  3.6058147905827342e-01,4.4692876015458138e-01,
                                  2.5496744648412184e-01,2.0035623021640769e-01,
                                  5.2243138466537731e-01},
                                 {4.5791503675119327e-01,8.5367446688446691e-01,
                                  4.5852811734789278e-02,9.1485127978572223e-01,
                                  3.5009701119579228e-01,1.4326691325413754e-02,
                                  9.2180391083421709e-01},
                                 {2.7576287506283381e-01,9.3730750057082202e-01,
                                  6.6137274016458181e-01,7.5552313787706082e-01,
                                  2.5875262615398587e-01,1.4402749350244148e-01,
                                  4.3376251191339033e-01},
                                 {4.1487001773947840e-01,5.9505681506703501e-01,
                                  9.5041579375246976e-01,2.6340623226034943e-01,
                                  2.4377994709040085e-01,9.8380280191747471e-01,
                                  4.1985922662713326e-01}},
                              
                                {{6.9473859441832753e-01,3.2185307973019761e-01,
                                  2.1121080376731549e-02,6.9842070352263941e-01,
                                  1.2935254684953590e-01,3.0338742453928380e-01,
                                  5.5348448934810057e-01},
                                 {4.6774342813406167e-01,9.4630379585128155e-01,
                                  3.5070686264325768e-01,7.5559742200637103e-03,
                                  3.7034814406422922e-01,6.8734037363928135e-02,
                                  4.4614906429986112e-03},
                                 {6.4037157686123680e-01,1.9890167735574382e-01,
                                  4.3037194668648027e-01,2.3542951320199179e-01,
                                  9.7305894001076620e-01,4.4532205907453215e-01,
                                  3.3559068631397637e-01},
                                 {1.9813318760750354e-01,6.8163460172651336e-01,
                                  7.3101522485117043e-01,6.7814568917449614e-01,
                                  6.7308628141664628e-01,4.6345171669091079e-01,
                                  6.8281411335488895e-01},
                                 {8.3265651181859313e-01,8.0358631614797227e-01,
                                  2.6305853589954531e-01,6.5811251290519568e-01,
                                  4.1160933544335154e-01,6.8526976058744360e-02,
                                  8.5389319588920543e-01},
                                 {6.6993018405068183e-01,1.2146536232864380e-01,
                                  7.2148717677229868e-01,1.2810609076429624e-01,
                                  8.1091067134993167e-01,5.5330981814980118e-01,
                                  3.3135774548078933e-01}},
                              
                                {{7.2315080385881858e-01,4.8044968004753541e-01,
                                  1.3660891483576798e-01,8.2793086377827041e-01,
                                  9.0124686844422752e-01,9.4336336067364734e-01,
                                  2.0763541622959458e-01},
                                 {7.3377518185578905e-01,8.4383524139684085e-01,
                                  8.7036175082877332e-01,1.9015795928995727e-01,
                                  5.4637144015102035e-01,9.4147321787558325e-01,
                                  4.6572321911077741e-01},
                                 {7.7828425398397294e-01,1.2114648085548352e-01,
                                  8.2904743466375697e-01,9.9124749225818343e-01,
                                  6.5950196774898795e-01,3.5146942177979923e-01,
                                  2.1860739063236423e-01},
                                 {3.3321865199407485e-01,8.6382827727360412e-01,
                                  3.4669137946784545e-01,9.1588425878502555e-01,
                                  2.5534249843555079e-01,9.6229001227263089e-01,
                                  1.9920905501980268e-01},
                                 {2.5752920517649625e-01,3.9831414522587127e-01,
                                  2.5268248944646388e-01,1.9307404483124613e-01,
                                  1.8945356440864147e-02,9.9479632354426373e-01,
                                  7.3952284812774594e-01},
                                 {4.0020653253757366e-01,9.8759229794959846e-01,
                                  3.5458924688222959e-01,8.3121111795844160e-01,
                                  4.0190078293173570e-01,8.6735210241975957e-01,
                                  2.2938587860922532e-01}}}};
        // py_av
        xarray<double> py_av = {{0.5921386552334917,0.4321741057229821,0.5309484765528958,
                                 0.5543468254414977,0.5636262291912509,0.5360889820737298,
                                 0.513075014658361 },
                                {0.4281912773927053,0.5500943215388141,0.4777100745332054,
                                 0.35976893497379  ,0.4315359163057602,0.5410702046010559,
                                 0.4396169811497922},
                                {0.5335131548353876,0.5958173241874269,0.606371857251771 ,
                                 0.573940429409235 ,0.5249093924855825,0.4334083464307479,
                                 0.5507076307615592},
                                {0.5112203661461623,0.706455978750368 ,0.5396800431572782,
                                 0.5201545453946113,0.4937432302106536,0.6073812173873598,
                                 0.5136156631525846},
                                {0.4336650740758257,0.677050599068886 ,0.5780661625094548,
                                 0.5206220708890781,0.504281642612738 ,0.5711968690718279,
                                 0.34692581600678  },
                                {0.5280787632835885,0.5194051179184589,0.3020894071512895,
                                 0.6298433441337232,0.4384433989596566,0.4937091559457326,
                                 0.5375951169242822}};

        auto av = xt::average(py_a, py_w, {0,1});

        EXPECT_TRUE(xt::allclose(av, py_av));
    }
}

